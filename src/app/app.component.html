
<div *ngIf="authService.currentUser$ | async as user; else notLoggedIn">
  <!-- Top bar: toolbar and auth widget side by side on mobile, spaced on desktop -->
  <div class="fixed top-4 left-4 right-4 z-50 flex flex-row items-start justify-between gap-2">
    <div class="flex-1 min-w-0">
      <app-toolbar class="w-full"></app-toolbar>
    </div>
    <app-auth-widget class="flex-shrink-0 w-80"></app-auth-widget>
  </div>
  
  <!-- Floating Sidebar -->
  <app-floating-sidebar></app-floating-sidebar>
  
  <app-map-view></app-map-view>
</div>
<ng-template #notLoggedIn>
  <app-home></app-home>
  <!-- For non-logged in state, we need the theme toggle in the corner -->
  <div class="fixed right-5 top-5 z-50 theme-button border rounded-md shadow-sm bg-black/20 backdrop-blur-md">
    <app-theme-toggle></app-theme-toggle>
  </div>
</ng-template>
